(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{ekgB:function(t,e,n){"use strict";n.r(e),n.d(e,"GameModule",(function(){return X}));var s=n("ofXK"),r=n("fXoL"),i=n("mrSG"),b=n("CCc+"),c=n("quSY"),h=n("HDdC");class d extends c.a{constructor(t,e){super()}schedule(t,e=0){return this}}class g extends d{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const n=this.id,s=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(s,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(s,this.id,e),this}requestAsyncId(t,e,n=0){return setInterval(t.flush.bind(t,this),n)}recycleAsyncId(t,e,n=0){if(null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let n=!1,s=void 0;try{this.work(t)}catch(r){n=!0,s=!!r&&r||new Error(r)}if(n)return this.unsubscribe(),s}_unsubscribe(){const t=this.id,e=this.scheduler,n=e.actions,s=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==s&&n.splice(s,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}}let a=(()=>{class t{constructor(e,n=t.now){this.SchedulerAction=e,this.now=n}schedule(t,e=0,n){return new this.SchedulerAction(this,t).schedule(n,e)}}return t.now=()=>Date.now(),t})();class l extends a{constructor(t,e=a.now){super(t,()=>l.delegate&&l.delegate!==this?l.delegate.now():e()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(t,e=0,n){return l.delegate&&l.delegate!==this?l.delegate.schedule(t,e,n):super.schedule(t,e,n)}flush(t){const{actions:e}=this;if(this.active)return void e.push(t);let n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}}const o=new l(g);var w=n("DH7j");function u(t){const{subscriber:e,counter:n,period:s}=t;e.next(n),this.schedule({subscriber:e,counter:n+1,period:s},s)}const f=["cat"];function p(t,e){if(1&t){const t=r.Hb();r.Gb(0,"angular-logo",5),r.Nb("failed",(function(){return r.Wb(t),r.Rb().failed()}))("success",(function(){return r.Wb(t),r.Rb().success()})),r.Fb()}if(2&t){const t=r.Rb();r.Sb("x",t.logoX)("step",4),r.vb("unitX",t.unitX)("unitY",t.startUnitY)}}function y(t,e){if(1&t&&(r.Gb(0,"div",6),r.ac(1),r.Fb()),2&t){const t=r.Rb();r.ub(1),r.bc(" Score: ",t.score,"\n")}}function v(t,e){if(1&t&&(r.Gb(0,"div",18),r.ac(1),r.Fb()),2&t){const t=r.Rb(2);r.ub(1),r.bc(" Score: ",t.finishScore," ")}}function P(t,e){if(1&t){const t=r.Hb();r.Gb(0,"div",7),r.Gb(1,"div",8),r.Gb(2,"div",9),r.ac(3," Angular Canvas "),r.Fb(),r.Zb(4,v,2,1,"div",10),r.Gb(5,"button",11),r.Nb("click",(function(){return r.Wb(t),r.Rb().startPlay()})),r.ac(6," START "),r.Fb(),r.Gb(7,"div"),r.ac(8,' Press "Left" and "Right" keys for game '),r.Fb(),r.Gb(9,"div",12),r.Gb(10,"a",13),r.Qb(),r.Gb(11,"svg",14),r.Eb(12,"path",15),r.Fb(),r.Fb(),r.Pb(),r.Gb(13,"a",16),r.Qb(),r.Gb(14,"svg",14),r.Eb(15,"path",17),r.Fb(),r.Fb(),r.Fb(),r.Fb(),r.Fb()}if(2&t){const t=r.Rb();r.ub(4),r.Sb("ngIf",t.finishScore)}}let m=(()=>{let t=class{constructor(t,e){this.elementRef=t,this.cdr=e,this.startUnitY=10,this.startUnitX=10,this.unitX=10,this.unitSize=6,this.unitSpeed=4,this.catSpriteIndex=0,this.logoX=250,this.revert=!1,this.rightPressed=!1,this.leftPressed=!1,this.downPressed=!1,this.score=0,this.finishScore=0,this.isPlayed=!1,this.subscription=new c.a}onKeyDownRight(t){this.rightPressed=!0,this.revert=!1}onKeyUpRight(t){this.rightPressed=!1}onKeyDownLeft(t){this.leftPressed=!0,this.revert=!0}onKeyUpLeft(t){this.leftPressed=!1}onKeyDownDown(t){this.downPressed=!0}onKeyUpDown(t){this.downPressed=!1}ngOnInit(){let t=1;this.subscription.add(function(t=0,e=o){var n;return n=t,(Object(w.a)(n)||!(n-parseFloat(n)+1>=0)||t<0)&&(t=0),e&&"function"==typeof e.schedule||(e=o),new h.a(n=>(n.add(e.schedule(u,t,{subscriber:n,counter:0,period:t})),n))}(500).subscribe(()=>{this.catSpriteIndex>2?t=-1:this.catSpriteIndex<=0&&(t=1),this.catSpriteIndex+=t})),this.startUnitY=Math.floor(this.elementRef.nativeElement.offsetHeight/1.35)}ngOnDestroy(){this.subscription.unsubscribe()}updateUnitX(t){this.unitX=t}failed(){this.isPlayed=!1,this.finishScore=this.score,this.score=0}success(){this.score+=1,this.unitSpeed+=1}startPlay(){this.isPlayed=!0,this.unitSpeed=4,this.cdr.detectChanges()}};return t.\u0275fac=function(e){return new(e||t)(r.Db(r.l),r.Db(r.h))},t.\u0275cmp=r.xb({type:t,selectors:[["app-game-canvas"]],viewQuery:function(t,e){var n;1&t&&r.cc(f,!0),2&t&&r.Tb(n=r.Ob())&&(e.cat=n.first)},hostBindings:function(t,e){1&t&&r.Nb("keydown.arrowright",(function(t){return e.onKeyDownRight(t)}),!1,r.Ub)("keyup.arrowright",(function(t){return e.onKeyUpRight(t)}),!1,r.Ub)("keydown.arrowleft",(function(t){return e.onKeyDownLeft(t)}),!1,r.Ub)("keyup.arrowleft",(function(t){return e.onKeyUpLeft(t)}),!1,r.Ub)("keydown.arrowdown",(function(t){return e.onKeyDownDown(t)}),!1,r.Ub)("keyup.arrowdown",(function(t){return e.onKeyUpDown(t)}),!1,r.Ub)},decls:10,vars:12,consts:[[3,"x","y","speed","size","spriteIndex","revert","rightPressed","leftPressed","downPressed"],["cat",""],[3,"x","step","failed","success",4,"ngIf"],["class","results",4,"ngIf"],["class","main-menu",4,"ngIf"],[3,"x","step","failed","success"],[1,"results"],[1,"main-menu"],[1,"menu-container"],[1,"menu-title"],["class","score",4,"ngIf"],[3,"click"],[1,"links"],["href","https://github.com/irustm/angular-canvas"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24"],["d","M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"],["href","https://twitter.com/irustm"],["fill","rgba(29,161,242)","d","M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"],[1,"score"]],template:function(t,e){1&t&&(r.Gb(0,"canvas"),r.Eb(1,"background"),r.Eb(2,"cactus"),r.Fb(),r.Gb(3,"canvas"),r.Gb(4,"cat",0,1),r.Nb("x",(function(t){return e.updateUnitX(t)})),r.Fb(),r.Fb(),r.Gb(6,"canvas"),r.Zb(7,p,1,4,"angular-logo",2),r.Fb(),r.Zb(8,y,2,1,"div",3),r.Zb(9,P,16,1,"div",4)),2&t&&(r.ub(4),r.Sb("x",e.startUnitX)("y",e.startUnitY)("speed",e.unitSpeed)("size",e.unitSize)("spriteIndex",e.catSpriteIndex)("revert",e.revert)("rightPressed",e.rightPressed)("leftPressed",e.leftPressed)("downPressed",e.downPressed),r.ub(3),r.Sb("ngIf",e.isPlayed),r.ub(1),r.Sb("ngIf",e.isPlayed),r.ub(1),r.Sb("ngIf",!e.isPlayed))},directives:[s.h],styles:["[_nghost-%COMP%]{display:block}.results[_ngcontent-%COMP%]{position:absolute;z-index:1;font-weight:600;font-size:18pt;padding:20px}.main-menu[_ngcontent-%COMP%]{position:absolute;z-index:11;top:calc(100% / 3);height:calc(100% / 3);width:100%}.menu-container[_ngcontent-%COMP%]{margin:auto;min-width:400px;min-height:200px;text-align:center}.menu-container[_ngcontent-%COMP%]   .menu-title[_ngcontent-%COMP%]{font-size:38pt;margin:14px;color:#dc73ce}.menu-container[_ngcontent-%COMP%]   .score[_ngcontent-%COMP%]{font-size:25pt}.menu-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:20px;font-size:20pt;background-color:#fffca4;padding:4pt 10pt}.links[_ngcontent-%COMP%]{margin-top:25px}.links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin:5px}"]}),t=Object(i.a)([b.a],t),t})(),x=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.xb({type:t,selectors:[["app-game-container"]],decls:1,vars:0,template:function(t,e){1&t&&r.Eb(0,"app-game-canvas")},directives:[m],styles:["[_nghost-%COMP%]{background-color:#dfa680}[_nghost-%COMP%], app-game-canvas[_ngcontent-%COMP%]{display:block;width:100%;height:100vh}"]}),t})();var S=n("tyNb"),k=n("npB/");function M(t){return t.split(/\n/).filter(Boolean).map(t=>t.split(""))}function O(t,e){return t.has(e)?t.get(e):"transparent"}function I(t,e,n,s,r,i){const b=e.length;for(let c=0;c<b;c++){const b=e[c];for(let e=0;e<b.length;e++)t.fillStyle=O(n,b[e]),t.fillRect(r+e*s,i+c*s,s,s)}}const C=["\n000000bb000b00\n000000bgbbbg00\n00b00bbbbbbb0b\n0b0000bbybbyb0\n0b000bbbbbbb0b\n0b00000wwww000\n00b000bbwww000\n000bbbbbbwb000\n000bbbbwbbbw00\n000bb0000bb000\n0000b00000b000\n","\n000000bb000b00\n000000bgbbbg00\n0b000bbbbbbb0b\n0b0000bbybbyb0\n0b000bbbbbbb0b\n0b00000wwww000\n00b000bbwww000\n000bbbbbbwb000\n000bbbbwbbbw00\n000bb0000bb000\n000b00000b0000\n","\n000000bb000b00\n000000bgbbbg00\n00000bbbbbbb0b\nb00000bbybbyb0\n0b000bbbbbbb0b\n0b00000wwww000\n00b000bbwww000\n000bbbbbbwb000\n000bbbbwbbbw00\n000bb0000bb000\n0000b00000b000\n","\n000000bb000b00\n000000bgbbbg00\n00000bbbbbbb0b\n000000bbybbyb0\nbb000bbbbbbb0b\n0b00000wwww000\n00b000bbwww000\n000bbbbbbwb000\n000bbbbwbbbw00\n000bb0000bb000\n000b00000b0000\n"].map(M),F=new Map([["0","transparent"],["b","#161326"],["w","white"],["y","#ffd800"],["g","#4c4c4c"]]);let R=(()=>{let t=class{constructor(){this.spriteIndex=0,this.revert=!1,this.rightPressed=!1,this.leftPressed=!1,this.downPressed=!1,this.speed=4,this.size=6}addEventListener(t,e){this.callbackFunc=e}removeEventListener(t,e){}setNgProperty(t,e){this[t]=e,this.parent.drawAll()}draw(t,e){let n=0;const s=this.size;this.rightPressed&&this.parent.element.width>this.x+84&&(n=this.downPressed?1:this.speed),this.leftPressed&&0<this.x&&(n=this.downPressed?-1:-this.speed),this.x+=n;let r=this.y;this.callbackFunc&&this.callbackFunc(this.x);const i=C[this.spriteIndex];let b=i.length;r+=2*s,b-=2,this.downPressed||!this.rightPressed&&!this.leftPressed||(r-=2*s,b+=2);for(let c=0;c<b;c++){let e=i[c];this.revert&&(e=e.slice().reverse());for(let n=0;n<e.length;n++)t.fillStyle=O(F,e[n]),t.fillRect(this.x+n*s,r+c*s,s,s)}this.needDraw=this.rightPressed||this.leftPressed}};return t=Object(i.a)([Object(k.CanvasElement)({selector:"cat"})],t),t})(),D=(()=>{let t=class{setNgProperty(t,e){this[t]=e,this.parent.drawAll()}draw(t,e){this.width=this.parent.element.width,this.height=this.parent.element.height,t.fillStyle="#abddff",t.fillRect(0,0,this.width,this.height/1.5),t.fillStyle="#a1ebfe",t.fillRect(0,0,this.width,this.height/1.8),t.fillStyle="#adf8ff",t.fillRect(0,0,this.width,this.height/2.2),t.fillStyle="#b3fcfe",t.fillRect(0,0,this.width,this.height/2.6),t.fillStyle="#d0fef9",t.fillRect(0,0,this.width,this.height/3),t.fillStyle="#ffffff",t.beginPath(),t.arc(Math.ceil(this.height/5),Math.ceil(this.height/6),Math.ceil(this.height/15),0,2*Math.PI,!1),t.fill()}};return t=Object(i.a)([Object(k.CanvasElement)({selector:"background"})],t),t})();const U=M("\n000000000gggg\n00000000gggggg\n0000000gggggggg\n0000000gggggggg\n0000000gggggggg\n0000000gggggggg\n000gg00gggggggg\n00gggg0gggggggg\n00gggg0gggggggg\n00cgggcgggggggg\n00cccccgggggggg\n000ccccgggggggg0gg\n0000000ggggggggcgc\n0000000ggggggggcc\n0000000gggggggg\n0000000gggggggg\n0000000gggggggg\n0000000gggggggg\n0000000cggggggc\n0000000ccggggcc\nw0wwwwwccccccccwwww0ww\n000000wwwwwwwwww\n"),G=new Map([["0","transparent"],["g","#5d9d83"],["c","#518b7f"],["w","#d1784b"]]);let _=(()=>{let t=class{setNgProperty(t,e){this[t]=e,this.parent.drawAll()}draw(t,e){this.height=this.parent.element.height-100;const n=Math.floor(this.height/1.5);I(t,U,G,6,200,n)}};return t=Object(i.a)([Object(k.CanvasElement)({selector:"cactus"})],t),t})();const A=M("\n0000000rrrr\n0000rrrrrdrrrr\n00rrrrrrwwdddrrr\nrrrrrrrwwwwddddrrr\nrrrrrrrwwwwdddddrr\nrrrrrrwwrdwwddddrr\nrrrrrrwwrdwwddddrr\nrrrrrrwwrdwwddddrr\nrrrrrwwrrddwwdddrr\nrrrrrwwrrddwwddrrr\n0rrrrwwwwwwwwddrr\n0rrrwwwwwwwwwwdrr\n0rrrwwrrrdddwwdrr\n0rrwwrrrrddddwwrr\n0rrwwrrrrddddwwrr\n0rrrrrrrrddddrrr\n000rrrrrrddrrrr\n00000rrrrdrrr\n000000rrrrrr\n0000000rrrr\n"),E=new Map([["0","transparent"],["r","#e15856"],["d","#ca413a"],["w","#ffffff"]]);let Y=(()=>{let t=class{constructor(){this.deltaY=0,this.step=1,this.callbackFunc={}}addEventListener(t,e){this.callbackFunc[t]=e}removeEventListener(t,e){}setNgProperty(t,e){this[t]=e,this.x&&this.step&&this.unitX&&this.parent.drawAll()}setAttribute(t,e){this[t]=e}draw(t,e){this.deltaY+=this.step,I(t,A,E,3,this.x,this.deltaY),this.needDraw=this.deltaY<this.parent.element.height,!this.needDraw&&this.callbackFunc.failed?(this.deltaY=-200,this.callbackFunc.failed()):this.callbackFunc.success&&this.x-42<this.unitX&&this.unitX<this.x+42&&this.deltaY-42<this.unitY&&this.unitY<this.deltaY+42&&(this.deltaY=-200,this.x=Math.ceil(Math.random()*this.parent.element.width)-42,this.step+=.5,this.callbackFunc.success())}};return t=Object(i.a)([Object(k.CanvasElement)({selector:"angular-logo"})],t),t})();n("5/jd");let X=(()=>{class t{}return t.\u0275mod=r.Bb({type:t}),t.\u0275inj=r.Ab({factory:function(e){return new(e||t)},imports:[[s.b,k.CanvasDomModule.forRoot([R,D,_,Y]),S.a.forChild([{path:"",component:x}])]]}),t})()}}]);